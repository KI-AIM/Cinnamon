
<div class="w-100 mb-2">
    <button mat-raised-button mat-dialog-close color="primary" type="button"
            (click)="openDialog(metricSelectionDialog)">Metric Importance
    </button>
</div>

<mat-form-field class="w-100">
    <mat-label>Search</mat-label>
    <input type="text" matInput [(ngModel)]="filterText"/>
</mat-form-field>


<div style="margin-top: -1rem;">
    <div *ngIf="(statistics$ | async) as statistics">
        <div *ngIf="(statistics.resemblance | statisticsFilter:filterText) as filteredAttributes">
            <div class="mb-2">Showing {{ filteredAttributes.filteredCount }}/ {{ filteredAttributes.originalCount }}
            </div>

            <div *ngFor="let attribute of filteredAttributes.filteredList" class="mb-2 border-top border-1">
                <div class="mt-2">
                    <app-data-inspection-attribute [attributeStatistics]="attribute" [sourceDataset]="sourceDataset"
                                                   [sourceProcess]="sourceProcess" [mainData]="mainData" [processingSteps]="processingSteps">
                    </app-data-inspection-attribute>
                </div>
            </div>
        </div>
    </div>
</div>

<ng-template #metricSelectionDialog>
    <h2 mat-dialog-title class="dialog-title fs-4 fw-bold">Metric Priority</h2>
    <mat-dialog-content class="mat-typography dialog-content">
        <div *ngIf="algorithmDefinition$ | async as algorithmDefinition">
            <div [formGroup]="importanceForm" class="vertical-boxes">
                <div *ngFor="let configGroup of algorithmDefinition.configurations | keyvalue" class="box">
                    <div class="box-name mb-1">
                        {{ configGroup.value.display_name }}
                    </div>

                    <table>
                        <tr *ngFor="let optionGroup of configGroup.value.options | keyvalue">
                            <td>
                                {{ optionGroup.value.display_name }}
                            </td>
                            <td>
                                <mat-radio-group [formControlName]="optionGroup.key" [id]="optionGroup.key">
                                    <mat-radio-button *ngFor="let importance of Object.values(MetricImportance)" [value]="importance">
                                        {{ MetricImportanceData[importance].label }}
                                    </mat-radio-button>
                                </mat-radio-group>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </mat-dialog-content>
    <mat-dialog-actions align="end">
        <button mat-raised-button mat-dialog-close color="primary" type="button">Close</button>
    </mat-dialog-actions>
</ng-template>
