<div class="vertical-boxes">
    <div class="box">
        <button mat-button mat-raised-button color="primary" (click)="printReport()">Print</button>
    </div>

    <ng-content *ngIf="{mc: metricConfig$ | async, statistics: statistics$ | async} as reportData">
        <ng-container *ngIf="reportData.mc && reportData.statistics">


            <div class="box" id="report">

                <!-- This div is printed -->
                <div class="report-root">

                    <div class="header">
                        <h1>Privacy Report</h1>
                        <p>Assessment of Resemblance, Utility and Privacy Risks</p>
                        <p>Report Date: 01.01.2025</p>
                    </div>

                    <div class="section">
                        <h2 class="header2">About this Report</h2>

                        <div class="intro-box">
                            <p>This privacy report serves as a crucial safeguard in the era of data-driven decision
                                making. This report provides a comprehensive assessment of how well synthetic data
                                maintains the analytical value of the original data while mitigating privacy
                                risks.</p>

                            <h3 class="header3">Who can use this report:</h3>
                            <div class="audience-block">
                                <div class="audience-item">
                                    <strong>Data Privacy Officers</strong>
                                    <p>To verify compliance with privacy regulations and validate anonymization
                                        effectiveness before data sharing or publication.</p>
                                </div>
                                <div class="audience-item">
                                    <strong>Data Scientists & Analysts</strong>
                                    <p>To understand utility limitations and statistical properties of the synthetic
                                        data for accurate model development and analysis.</p>
                                </div>
                                <div class="audience-item">
                                    <strong>Medical Staff</strong>
                                    <p>To make informed decisions about data usage, sharing, and monetization while
                                        managing privacy risks and compliance.</p>
                                </div>
                            </div>

                            <h3 class="header3">This report enables to:</h3>
                            <ul>
                                <li><strong>Verify Privacy Protection:</strong> Evaluate if data meets regulatory
                                    requirements and organizational privacy standards before use.
                                </li>
                                <li><strong>Assess Data Quality:</strong> Determine if the anonymized data maintains
                                    sufficient utility for intended analytics and AI use cases.
                                </li>
                                <li><strong>Make Informed Trade-offs:</strong> Balance privacy enhancement methods
                                    against analytical utility needs.
                                </li>
                                <li><strong>Document Due Diligence:</strong> Maintain evidence of privacy
                                    assessments for compliance and governance purposes.
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="section">
                        <h2 class="header2">Executive Summary</h2>
                        <p>Here are the three dimensions, resemblance, utility, Privacy Risk displayed these values
                            are aggregated for the whole data set. Detailed analysis can be found in the following
                            chapters.</p>

                        <div
                            style="display: flex; flex-wrap: wrap; justify-content: space-between; margin-top: 20px;">
                            <div class="metric-card" style="flex: 1; min-width: 200px; margin: 0 10px 10px 0;">
                                <div style="font-weight: bold;">Data Resemblance Score</div>
                                <div style="font-size: 24px; color: #3498db;">87%</div>
                                <div style="font-size: 14px; color: #7f8c8d;">Statistical similarity to original
                                    data
                                </div>
                            </div>
                            <div class="metric-card" style="flex: 1; min-width: 200px; margin: 0 10px 10px 0;">
                                <div style="font-weight: bold;">Utility Preservation</div>
                                <div style="font-size: 24px; color: #3498db;">92%</div>
                                <div style="font-size: 14px; color: #7f8c8d;">Analytical accuracy compared to
                                    original
                                </div>
                            </div>
                            <div class="metric-card" style="flex: 1; min-width: 200px; margin: 0 0 10px 0;">
                                <div style="font-weight: bold;">Privacy Risk Score</div>
                                <div style="font-size: 24px; color: #3498db;">Low</div>
                                <div style="font-size: 14px; color: #7f8c8d;">Re-identification risk below 0.01%
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h2 class="header2">1. Overview</h2>

                        <p>This anonymized Dataset contains 1000 records. And has 11 Attributes over all. More
                            details about the data set can be found in the table below.</p>

                        <table class="report-table">
                            <tr>
                                <th class="report-th">Characterisitc</th>
                                <th class="report-th">Original Dataset</th>
                                <th class="report-th">Anonymized Dataset</th>
                            </tr>
                            <tr>
                                <td class="report-td">Number of Records</td>
                                <td class="report-td">1000</td>
                                <td class="report-td">1000</td>
                            </tr>
                            <tr>
                                <td class="report-td">Number of Attributes</td>
                                <td class="report-td">11</td>
                                <td class="report-td">10</td>
                            </tr>
                            <tr>
                                <td class="report-td">Number of Numeric Attributes</td>
                                <td class="report-td">4</td>
                                <td class="report-td">3</td>
                            </tr>
                            <tr>
                                <td class="report-td">Number of Nominal Attributes</td>
                                <td class="report-td">6</td>
                                <td class="report-td">5</td>
                            </tr>
                            <tr>
                                <td class="report-td">Number of Date Attributes</td>
                                <td class="report-td">1</td>
                                <td class="report-td">1</td>
                            </tr>
                        </table>

                        <h3 class="header3">Anonymization Methods</h3>
                        <p>In this section the applied privacy-preserving transformations are displayed. Therefore,
                            first the used privacy model is shown and then which attribute is transformed.</p>

                        <h4>Privacy Model:</h4>
                        <table class="report-table">
                            <tr>
                                <th class="report-th">Parameter</th>
                                <th class="report-th">Value</th>
                            </tr>
                            <tr>
                                <td class="report-td">Risk Threshold Type</td>
                                <td class="report-td">Max</td>
                            </tr>
                            <tr>
                                <td class="report-td">Risk Threshold Value</td>
                                <td class="report-td">0.1</td>
                            </tr>
                            <tr>
                                <td class="report-td">Generalization Setting</td>
                                <td class="report-td">Global</td>
                            </tr>
                            <tr>
                                <td class="report-td">Supression Limit</td>
                                <td class="report-td">0.7</td>
                            </tr>
                        </table>

                        <h4>Attribute Transformation:</h4>
                        <table class="report-table">
                            <tr>
                                <th class="report-th">Attribute</th>
                                <th class="report-th">Transformation Function</th>
                                <th class="report-th">Parameter</th>
                            </tr>
                            <tr>
                                <td class="report-td">Age</td>
                                <td class="report-td">MICRO_AGGREGATION</td>
                                <td class="report-td">Aggregation Interval: 10</td>
                            </tr>
                            <tr>
                                <td class="report-td">Gender</td>
                                <td class="report-td">NONE</td>
                                <td class="report-td">NONE</td>
                            </tr>
                            <tr>
                                <td class="report-td">Income</td>
                                <td class="report-td">MICRO_AGGREGATION</td>
                                <td class="report-td">Aggregation Interval: 1000</td>
                            </tr>
                            <tr>
                                <td class="report-td">…</td>
                                <td class="report-td">…</td>
                                <td class="report-td">…</td>
                            </tr>
                        </table>

                        <h3 class="header3">Synthetization Methods</h3>
                        <p>CTGAN was applied to create synthetic versions of attributes while preserving statistical
                            properties and relationships. The following Parameters are used for the
                            synthetization:</p>
                        <table class="report-table">
                            <tr>
                                <th class="report-th">Parameter</th>
                                <th class="report-th">Value</th>
                            </tr>
                            <tr>
                                <td class="report-td">Epochs</td>
                                <td class="report-td">100</td>
                            </tr>
                            <tr>
                                <td class="report-td">Batch Size</td>
                                <td class="report-td">100</td>
                            </tr>
                            <tr>
                                <td class="report-td">…</td>
                                <td class="report-td">…</td>
                            </tr>
                        </table>
                    </div>

                    <div class="section">
                        <h2 class="header2">2. Resemblance Analysis</h2>

                        <p>The resemblance analysis evaluates how closely the synthetic/anonymized data preserves
                            the statistical properties of the original data. Overall, the dataset achieves high
                            fidelity with 87% resemblance score. Distribution analysis shows 71% of attributes
                            maintain excellent resemblance (>90%), 22% show good resemblance (75-90%), and 7%
                            require improvement (&lt;75%). All of the used metrics and their individual assessment
                            can be seen in Section 5.</p>

                        <h3 class="header3">Attribute Level Resemblance</h3>
                        <p>The table below presents the aggregated resemblance metrics for each attribute, with
                            lower scores meaning better resemblance:</p>
                        <table class="report-table">
                            <tr>
                                <th class="report-th">Attribute</th>
                                <th class="report-th">Aggregated Resemblance Score</th>
                                <th class="report-th">Assessment</th>
                            </tr>
                            <tr>
                                <td class="report-td">Age</td>
                                <td class="report-td">0.05</td>
                                <td class="risk-low">Excellent</td>
                            </tr>
                            <tr>
                                <td class="report-td">Gender</td>
                                <td class="report-td">0.17</td>
                                <td class="risk-low">Good</td>
                            </tr>
                            <tr>
                                <td class="report-td">Income</td>
                                <td class="report-td">0.29</td>
                                <td class="risk-medium">Medium</td>
                            </tr>
                            <tr>
                                <td class="report-td">…</td>
                                <td class="report-td">…</td>
                                <td class="report-td">…</td>
                            </tr>
                        </table>
                    </div>

                    <div class="section">
                        <h2 class="header2">3. Utility Analysis</h2>

                        <p>Utility analysis evaluates how well the anonymized data performs in actual analytical
                            tasks compared to the original data. We trained identical machine learning models on
                            both the original and anonymized datasets, then compared their performance on a separate
                            validation set. The anonymized data achieved 92% overall utility preservation, with 75%
                            of models showing high utility retention (>90%), 23% with acceptable utility (75-90%),
                            and only 2% with significant degradation (&lt;75%). The used models as well as a
                            Detailed overview of the metrics can be seen in Section 5.</p>

                        <h3 class="header3">Discriminator-based Analysis</h3>
                        <p>This analysis tries to train a machine learning model that is able to distinguish between
                            real and anonymized data values in the range of 0.5 are preferable that means the model
                            cannot distinguish between real and anonymized data.</p>
                        <table class="report-table">
                            <tr>
                                <th class="report-th">Metric</th>
                                <th class="report-th">Identification Score</th>
                                <th class="report-th">Assessment</th>
                            </tr>
                            <tr>
                                <td class="report-td">Accuracy</td>
                                <td class="report-td">0.5</td>
                                <td class="risk-low">Excellent</td>
                            </tr>
                            <tr>
                                <td class="report-td">F1 Score</td>
                                <td class="report-td">0.45</td>
                                <td class="risk-low">Excellent</td>
                            </tr>
                            <tr>
                                <td class="report-td">Recall</td>
                                <td class="report-td">0.5</td>
                                <td class="risk-low">Excellent</td>
                            </tr>
                            <tr>
                                <td class="report-td">Precision</td>
                                <td class="report-td">0.47</td>
                                <td class="risk-medium">Medium</td>
                            </tr>
                        </table>

                        <h3 class="header3">Machine Learning Utility</h3>
                        <p>This analysis shows how usable is the anonymized data compared to the real data in terms
                            of machine learning tasks. Therefore the anonymized data is used to train models that
                            are tested on the real data.</p>
                        <table class="report-table">
                            <tr>
                                <th class="report-th">Metric</th>
                                <th class="report-th">Original Data</th>
                                <th class="report-th">Anonymized Data</th>
                                <th class="report-th">Difference</th>
                                <th class="report-th">Assessment</th>
                            </tr>
                            <tr>
                                <td class="report-td">Accuracy</td>
                                <td class="report-td">0.9</td>
                                <td class="report-td">0.85</td>
                                <td class="report-td">0.05</td>
                                <td class="risk-low">Excellent</td>
                            </tr>
                            <tr>
                                <td class="report-td">F1 Score</td>
                                <td class="report-td">0.8</td>
                                <td class="report-td">0.75</td>
                                <td class="report-td">0.05</td>
                                <td class="risk-low">Excellent</td>
                            </tr>
                            <tr>
                                <td class="report-td">Recall</td>
                                <td class="report-td">0.7</td>
                                <td class="report-td">0.75</td>
                                <td class="report-td">0.05</td>
                                <td class="risk-low">Excellent</td>
                            </tr>
                            <tr>
                                <td class="report-td">Precision</td>
                                <td class="report-td">0.7</td>
                                <td class="report-td">0.5</td>
                                <td class="report-td">0.25</td>
                                <td class="risk-medium">Medium</td>
                            </tr>
                        </table>
                    </div>

                    <div class="section">
                        <h2 class="header2">4. Risk Analysis</h2>

                        <p>Privacy risk analysis evaluates the likelihood that individuals in the dataset could be
                            re-identified through various attacks. The anonymized dataset demonstrates strong
                            overall privacy protection with 98.9% of records classified as low risk. The small
                            proportion of records with elevated risk (1.1% combined medium and high risk) remains
                            below acceptable thresholds for most regulatory frameworks. All attack vectors assessed
                            show risk probabilities below 1.5%, with the exception of attribute disclosure which
                            shows slightly elevated risk (1.24%) but still within acceptable parameters.</p>

                        <table class="report-table">
                            <tr>
                                <th class="report-th">Risk Level</th>
                                <th class="report-th">Number of Attributes</th>
                                <th class="report-th">Risk Score</th>
                            </tr>
                            <tr>
                                <td class="risk-high">High</td>
                                <td class="report-td">5</td>
                                <td class="report-td">0.05</td>
                            </tr>
                            <tr>
                                <td class="risk-medium">Medium</td>
                                <td class="report-td">3</td>
                                <td class="report-td">0.75</td>
                            </tr>
                            <tr>
                                <td class="risk-low">Low</td>
                                <td class="report-td">2</td>
                                <td class="report-td">0.75</td>
                            </tr>
                        </table>
                    </div>

                    <div
                        style="text-align: center; margin-top: 50px; padding-top: 20px; border-top: 1px solid #eee; color: #7f8c8d; font-size: 14px;">
                        <p>Privacy Report | Prepared: 01.01.2025</p>
                        <p>Confidential - For Internal Use Only</p>
                    </div>

                <div style="width: 100%;">
                    <app-chart-frequency id="chart" #chart
                                         [colorScheme]="reportData.mc.metricConfiguration.colorScheme"
                                         [data]="reportData.statistics.statistics!.resemblance.attributes[0].plot.histogram!"
                                         [limit]="null" originalSeriesLabel="Original" [simple]="true"
                                         syntheticSeriesLabel="Protected"></app-chart-frequency>
                </div>

                </div>

            </div>

        </ng-container>
    </ng-content>
</div>
